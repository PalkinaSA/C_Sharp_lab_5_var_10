# Лабораторная работа №5 по дисциплине "Языки программирования" Вариант 10
# Текст задания: 
Разработать консольное приложение с дружественным интерфейсом с возможностью выбора 
заданий. Приложение должно выполнять следующие функции: 
1. Чтение базы данных из excel файла.
2. Просмотр базы данных.
3. Удаление элементов (по ключу).
4. Корректировка элементов (по ключу).
5. Добавление элементов.
6. Реализация 4 запросов (формулировки запросов придумать самостоятельно и отразить в 
отчёте, можно использовать запрос, данный в примере): 
6.1. 1 запрос с обращением к одной таблице
6.2. 1 запрос с обращением к двум таблицам
6.3. 2 запроса с обращением к трем таблицам
(2 запроса должны возвращать перечень, 2 запроса одно значение.)
7. Во время всего сеанса работы ведется полное протоколирование действий в текстовом 
файле (в начале сеанса запросить, будет ли это новый файл или дописывать в уже 
существующий).
Элементами базы данных являются объекты классов согласно вашему варианту. Содержание классов 
определить самостоятельно (в классах должны присутствовать свойства,
конструкторы, перегруженный метод ToString). Весь функционал приложения реализовать в виде 
методов вспомогательного класса с помощью LINQ-запросов.
Предусмотреть обработку возможных ошибок при работе программы.

В файле LR5-var10.xls приведён фрагмент базы данных «Продукты» о поставках товаров в магазины 
районов города. База данных состоит из трёх таблиц. Таблица «Движение товаров» содержит записи о 
поставках товаров в магазины, а также информацию о проданных товарах. Поле Тип операции 
содержит значение Поступление или Продажа, а в соответствующее поле Количество упаковок, шт. 
занесена информация о том, сколько упаковок товара поступило в магазин или было продано в 
течение дня. Таблица «Товар» содержит информацию об основных характеристиках каждого товара. 
Таблица «Магазин» содержит информацию о местонахождении магазинов. На рисунке приведена 
схема указанной базы данных.

<img width="386" height="224" alt="товары" src="https://github.com/user-attachments/assets/88d37b98-0ebf-47fa-a86d-69b7310585d5" />

Пример запроса: 
Определите общий объем (в литрах) всех видов шампуней для волос, проданных магазинами, 
расположенными на улице Гагарина, за период с 14 по 22 июля включительно. В ответ запишите 
целую часть числа. 
Ответ: 855 

# Алгоритм решения:
0. Для начала создаём классы Product (представление таблицы "Товар"), ProductMovement (представление таблицы "Движение товаров") и Shop (представление таблицы "Магазин"). Добавляем приватные поля и публичные свойства с проверкой корректности переданных данных. Например, в классе Product артикул товара не может быть меньше 1, в классе Shop адрес магазина не может быть пустым, а в классе ProductMovement тип операции может быть либо "Поступление", либо "Продажа". Добавляем конструкторы по умолчанию, конструкторы со всеми параметрами, перегружаем метод ToString() для каждого из классов. 
1. Чтение базы данных происходит из excel-файла LR5-var10.xls с помощью библиотеки ExcelDataReader. Из файла считываются 3 листа: "Товар", "Магазин" и "Движение товаров". Данные хзаносятся в списка объектов Product, Shop и ProductMovement. Пользователь выбирает перезаписывать ли ему базу данных приложения, если она заполнена данными. Можно перезаписывать базу данных тогда, когда этого хочет пользователь.
2. Просмотр базы данных происходит с помощью библиотеки ConsoleTables. Пользователь может выбрать, какую из трёх таблиц вывести на экран. 
3. Добавление записей происходит с проверкой корректности данных. Пользователь не может сам заносить данные в первичные ключи (они генерируются программой на основе данных, имеющихся в базе). Удаление происходит по ключу (артикул для товаров, ID магазина для магазинов и номер операции для движений товаров). При удалении товара или магазина каскадно удаляются связанные записи в таблице "Движение товаров". Корректировка элементов происходит по ключу (артикул для товаров, ID магазина для магазинов и номер операции для движений товаров). Ввод новых данных происходит с валидацией. Ключ изменять нельзя. 
4. Реазилованы 4 запроса с использованием LINQ: 1) найти максимальную цену товара в таблице товаров (обращается к 1 таблице, возвращает число). 2) найти список операций по товарам выбранного отдела (обращается к 2-м таблтицам, возвращает список). 3) найти список адресов магазинов, где продавался товар с заданным названием (обращается к 3-м таблицам, возвращает список). 4) вычисляет общую выручку магазинов заданного района (обращается к 3-м таблицам, возвращает число). 
5. Логирование реализовано через txt-файл log.txt, который генерируется и заполняется в ходе выполнения программы. Перед запуском программы можно выбрать создать ли новый файл логирования/перезаписать старый или допиысывать в уже существующий. Если файл ещё не создан, а пользователь выбрал дописывать в существующий файл, то этот файл сначала создаётся. В лог-файл заносится каждая операция над базой данных. Формат записи: Дата | Тип информации | Сообщение
Обработка ошибок происходит с помощью try-catch и TryParse, а также проверок на пустые значения. В случае неверных данных пользователь получает сообщение об этом и действие фиксируется в файле логирования.
# Тестирование
